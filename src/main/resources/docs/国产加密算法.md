# 密码算法简单分享

## 一、密码算法

### 1. 什么是密码算法

> 在《辞海》(1999年版)中对密码是这样释意的:“按特定法则编成,用以对通信双方的信息进行明密变换的符号”。换而言之,密码是隐蔽了真实内容的符号序列。就是把用公开的、标准的信息编码表示的信息通过一种变换手段,将其变为除通信双方以外其他人所不能读懂的信息编码,这种独特的信息编码就是**密码**。
>
> 出于信息保密的目的，在信息传递或存储过程中，采用密码技术对需要保密的信息进行处理，使得处理后的信息不能被非受权者（含非法者）读懂或解读的过程叫做加密。加密处理过程中,需要保密的信息称为“明文”,经加密处理后的信息称为“密文”。加密即是将“明文”变为“密文”的过程;与此类似,将“密文”变为“明文”的过程被称为解密。
>
> ——国家密码局（https://www.oscca.gov.cn/）

**加密算法**是实现密码对信息进行”明“、”密“转换的一种特定规则，不同的算法有不同的变换规则，一般我们说的加密算法指的是各类和密码相关算法的统称。比如说：

- 加密算法
- 解密算法
- 签名算法
- 认证算法
- …

### 2. 加密算法的分类

加密算法按照特点可以分为三类：对称密码算法，非对称密码算法，摘要算法。

#### 2.1. 对称加密算法

指的是<font color=red>加密密钥和解密密钥是同一个</font>的密码算法，按照处理方式不同，又分为**分组密码算法**和**流密码算法**

* *分组密码算法（块加密算法）：*加密步骤分三步。**a.**将明文拆分为N个固定长度的明文块； **b.**用相同的密钥和算法对每个明文块加密得到N个等长的密文块； **c.**将N个密文块按照顺序组合得到完整密文。
* *流密码算法（序列密码算法）：* 每次只加密一位或一字节明文。

常见的分组密码算法包括AES、SM1（国密）、SM4（国密）、DES、3DES、IDEA、RC2等；

常见的流密码算法包括RC4等；

> - **AES**：目前安全强度较高、应用范围较广的对称加密算法
> - **SM1**：国密，采用硬件实现（智能门锁、加密卡）
> - **SM4**：国密，可使用软件实现
> - **DES/3DES**：已被淘汰或逐步淘汰的常用对称加密算法



#### 2.2. 非对称加密算法

指的是<font color=red>加密密钥和解密密钥不同</font>的密码算法，又称为公钥算法，这种密码算法一般使用公钥进行加密，使用私钥进行解密，当然也可以反过来用，反过来用叫做签名和验签，既私钥签名，公钥验签。  

- 使用非对称加密算法计算出的一对公钥和私钥合称密钥对。
- 加密密钥可以公开，交给除自己以外的用户（不止指人，还包括受信任的软硬件设施等等）保存，称为**公钥**。
- 解密密钥必须保密，只有自己可以使用，称为**私钥**。
- 私钥一旦丢失，那么这个密钥对将不再安全，密钥对必须立即作废。

常见的非对称算法包括RSA、SM2（国密）、DH、DSA、ECDSA、ECC等



#### 2.3. 摘要算法

摘要算法是指把任意长度的明文消息数据转化为固定长度的密文数据的密钥算法，又称为散列算法、杂凑算法、哈希算法 等

摘要算法所产生的的固定长度的密文数据称之为摘要值、散列值或哈希值

摘要算法的特点：

- 摘要算法无密钥
- 消息一旦加密，将无法逆向恢复成原来的明文消息
- 消息即使发生微小变动，摘要值也会完全不同

因为这些特点，摘要算法通常用来做数据完整性的验证判定操作，也就是对消息进行摘要后比对摘要值是否一致。

摘要算法主要分为三个系列：消息摘要算法（MD）、安全散列算法（SHA）、消息认证码算法（MAC）

- MD系列：MD2、MD4、MD5
- SHA系列：SHA-1、SHA-2（SHA-224、SHA-512）
- MAC系列：HmacMD5、HmacSHA1、HmacSHA256、HmacSHA384等



## 二、国际加密算法

通常意义上的国际加密算法指的是除我国自研的SM系列算法、祖冲之序列密码算法等算法以外的国际通用算法。

### 1. 对称加密算法

#### 1.1. DES算法

​		DES（Data Encryption Standard）算法，即`美国数据加密标准算法`，是1972年美国IBM公司研制的对称密码体制加密算法。明文按64位进行分组，密钥长度为64位，密钥事实上是56位参与DES运算。

其加密方式主要采用替换和移位的方式对切割后的数据块进行逐块加密。每次加密对64位的数据进行16轮编码，经过 一系列的替换和移位后得到密文

特点：

- 对数据分组进行加密，64位一组，数据块大小为8个字节
- 密钥长度为64位，8个字节，每个字节的最后一位用作校验，实际参与加密运算的只有56位。

1999年1月，RSA数据安全公司宣布:该公司所发起的对56位DES的攻击已经由一个称为电子边境基金(EFF)的组织,通过互联网上的100000台计算机合作在22小时15分钟内完成。（被破解）



#### 1.2. AES算法

​		密码学中的高级加密标准（`Advanced Encryption Standard`，AES），是美国联邦政府采用的一种区块加密标准，用来替代不安全的DES，2001年正式发布，2006年，成为对称密钥加密中最流行的算法之一。

其加密方式主要 

特点：

- 对数据进行分组加密，128位一组，数据块大小为16字节
- 密钥长度为128位，16字节

> AES密码与分组密码Rijndael基本上完全一致，Rijndael分组大小和密钥大小都可以为128位、192位和256位。然而AES只要求分组大小为128位，因此只有分组长度为128Bit的Rijndael才称为AES算法。



### 2. 非对称密钥算法

#### 2.1. RSA算法

RSA加密算法是被研究最广泛的公钥算法，是目前应用最广泛的公钥方案之一，是一种基于大素数因子分解困难问题上的算法。通常认为RSA的破译难度与大数的素因子分解难度等阶。

被破解的最长RSA密钥是768个二进制位；长度超过768位的密钥，还无法破解（至少没人公开宣布）。

原理：

1. 随意选择两个大的质数*p*和*q*，*p*不等于*q*，选择一个小于*r*并且与*r*互为质数的奇数 *e*，计算 *N = pq*[^1]; 
2. 求得：*r =  φ(N)  =  φ(p)φ(q)  =  (p−1)(q−1)*[^2]
3. 得到公钥：（*N，e*）也就是（3127，3），计算*d = (kφ(n)+1)/e*[^3]， 得到私钥：（*N，d*）也就是（3127，2011）
4. 假定明文为 81， 那么公钥加密过程就是***(m^e) mod n=c***，也就是（81^3）mod 3127 = 2978， 密文为 2978
5. 得到密文为 2978，那么密钥解密过程就是***(c^d) mod n=m***，也就是（2978^2011）mod 3127 = 81，得到密文为 81

特点：

- 加密密钥和解密密钥不是同一个，公钥加密，私钥解密；

- 很难从公钥推出私钥；

### 3. 摘要算法

#### 3.1. MD5算法

#### 3.2. SHA算法



## 三、国密加密算法

- SM2（椭圆曲线公钥密码算法）
- SM3（密码杂凑算法）
- SM4（分组密码算法）
- SM9（标识密码算法）
- ZUC（祖冲之序列密码算法）
  - 新一代宽带无线移动通信系统(LTE)国际标准

### 1. 对称密钥算法

#### 1.1 SM4算法

​        SM4**分组密码算法**是我国自主设计的分组对称密码算法，用于实现数据的加密/解密运算，  解密过程与加密过程的结构相似,只是轮密钥的使用顺序相反以保证数据和信息的机密性。要保证一个对称密码算法的安全性的基本条件是其具备足够的密钥长度，SM4算法与AES算法具有相同的密钥长度分组长度128 bit，安全性与AES相同。

特点：

- 明文、密钥、密文都是16字节,加密和解密密钥相同
- 加密算法与密钥扩展算法都采用32轮非线性迭代结构
- 

### 2. 非对称密钥算法

#### 2.1. SM2算法

​        SM2**椭圆曲线公钥密码算法**是我国自主设计的公钥密码算法，包括**SM2-1**椭圆曲线数字签名算法，**SM2-2**椭圆曲线密钥交换协议，**SM2-3**椭圆曲线公钥加密算法，分别用于实现数字签名密钥协商和数据加密功能。相比于RSA算法，256位的SM2密码强度已经比2048位的RSA密码强度要高。在实际使用中，国密局推荐使用素数域256位椭圆曲线，曲线方程为
$$
y^2 = x^3 + ax + b
$$
其中p是大于3的一个大素数，n是基点G的阶，Gx、Gy 分别是基点G的x与y值，a、b是随圆曲线方程的系数

> 曲线参数：
>
>  p=FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 00000000 FFFFFFFF FFFFFFFF
>
>  a=FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 00000000 FFFFFFFF FFFFFFFC
>
>  b=28E9FA9E 9D9F5E34 4D5A9E4B CF6509A7 F39789F5 15AB8F92 DDBCBD41 4D940E93 
>
> n=FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF 7203DF6B 21C6052B 53BBF409 39D54123 
>
> Gx=32C4AE2C 1F198119 5F990446 6A39C994 8FE30BBF F2660BE1 715A4589 334C74C7 
>
> Gy=BC3736A2 F4F6779C 59BDCEE3 6B692153 D0A9877C C62A4740 02DF32E5 2139F0A0
>
> —— 国家密码管理局发布 《SM2椭圆曲线公钥密码算法》公告（https://sca.gov.cn/sca/xwdt/2010-12/17/content_1002386.shtml）

### 3. 摘要算法

#### 3.1 SM3算法

​        SM3**杂凑算法**是我国自主设计的密码杂凑算法，适用于商用密码应用中的数字签名和验证消息认证码的生成与验证以及随机数的生成，可满足多种密码应用的安全需求。

​        为了保证杂凑算法的安全性，产生的杂凑值的长度就不应太短，例如MD5输出128 bit 杂凑值，输出长度太短，影响其安全性；SHA-1算法的输出长度为160 bit，SM3算法的输出长度为256 bit，因此SM3算法的安全性要高于MD5算法和SHA-1算法













[^1]: 例如：53、59、3，N = 53*59 = 3127
[^2]: φ(3127) = (53-1)(59-1) = 3016
[^3]: (2*3016+1)/3 = 2011

